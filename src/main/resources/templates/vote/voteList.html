<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<style>
.vote:hover{
	opacity:0.5;
	cursor: pointer;	
}
</style>
</head>

<body>
	<div class="row">
		<div class="card">
			<div class="card-header">
				<h4 class="card-title">투표</h4>
				<hr>
				<button type="button" onclick="voteInsert()"
					class="btn btn-block btn-light-primary font-bold mt-3">+
					투표 만들기</button>
			</div>
			<div class="card-content">
				<div class="card-body" id="vote">				
				</div>
			</div>
		</div>
	</div>
	
<script>
	$.ajax("voteList")
		.done(result=>{
		for(i of result){
			let div;
			if (i.boardNm != null){
			div=`<div class="vote" onclick="voteInfo()" id=${i.voteNo}>
				<h4 class="card-title">장소:${i.boardNm}</h4>
				<h2>제목:${i.ttl}</h2>
				<small class="text-muted">${i.cnt}명 참여</small>
				<p class="card-text">~${i.toDt}까지 마감</p>
				</div>
			`;
			}else if(i.chatrNm != null){
				div=`<div class="vote" onclick="voteInfo()" id=${i.voteNo}>
					<h4 class="card-title">장소:${i.chatrNm}</h4>
					<h2>제목:${i.ttl}</h2>
					<small class="text-muted">${i.cnt}명 참여</small>
					<p class="card-text">~${i.toDt}까지 마감</p>
					</div>
				`;
			}
			
			$('#vote').append(div);
			
			
			
			}
 		
 			
		
		})
 		
		//투표 상세로 가기
 	function voteInfo(){
		let vid = event.target.closest('div').id;
		 $.ajax("voteInfo/"+vid)
		.done(result =>{
			$("#rsidebarContent").html(result);
		}) 
	}	
		
		//투표 생성 폼으로 가기
  	function voteInsert(){
	$.ajax("voteInsert")
	.done(result=>{
		$("#rsidebarContent").html(result);
		})
		} 
	
	/* 	$.ajax("voteInsert")
		.done(function(result){
			$("#rsidebarContent").html(result);
		})	
	} */
	
	
</script>
</body>
</html>