<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8' />
<script src='/dist/index.global.js'></script>
<script>
// document.addEventListener('DOMContentLoaded', async function() {
  // await fetch('/readWorkSchView') 1. 이거 주석단 이유!
  
  var calendarEl = document.getElementById('calendar');
  let allEvents = schAllDatas;
  console.log('데이터', allEvents);
  
  let formattedEvents = allEvents.map(eventData => ({
    title: eventData.title,
    start: eventData.start,
    end: eventData.end,
    color: eventData.postType == '1' ? 'indianred' : '#35A880',
    classNames: 'sideWork',
    extendedProps: {
        proPostNo: eventData.proPostNo
    }
  }));



  var calendar = new FullCalendar.Calendar(calendarEl, {
    headerToolbar: {
      left: 'prev,next today',
      center: 'title',
      right: 'dayGridMonth,timeGridWeek,timeGridDay,listMonth'
    },
    eventClick: function(info) {
      console.log('이벤트: ' + info.event.title);
      //console.log('Coordinates: ' + info.jsEvent.pageX + ',' + info.jsEvent.pageY);
      //console.log('View: ' + info.view.type);
         let postNo = info.event.extendedProps.proPostNo;
      //console.log(postNo);
      // change the border color just for fun
      //info.el.style.borderColor = 'red';
      info.jsEvent.preventDefault();
      if (info.event.url) {
        window.open(info.event.url);
      }
     // console.log('event.target',event.target);
      //console.log('event.target',event.target.closest('.sideWork'));


         var $buttons = $('.sideWork');
         var $modals = $('.custom-modal');
         
        
         //console.log('찾는거',postNo)

         //모달 전체 닫기
         $modals.not('#modal' + postNo).removeClass('show-modal');

         $('#modal' + postNo).toggleClass('show-modal');


         // X버튼으로 닫기
         $('.closeModalButton').click(function () {
               $(this).closest('.custom-modal').removeClass('show-modal');
         });
         


    },
    dayMaxEventRows: true, // for all non-TimeGrid views
    views: {
      timeGrid: {
        dayMaxEventRows: 3 // adjust to 6 only for timeGridWeek/timeGridDay
      }
    },
    initialDate: new Date(), // 오늘날짜 넣기
    navLinks: true, // can click day/week names to navigate views.날짜를 선택하면 Day 캘린더나 Week 캘린더로 링크
    businessHours: false, // display business hours
    editable: false,//수정 가능?
    selectable: false,// 달력 일자 드래그 설정가능
    //dayMaxEvents: false, // 이벤트가 오버되면 높이 제한 (+ 몇 개식으로 표현)
    //locale: 'ko',
    events: formattedEvents
    
    
    
  });
  
  calendar.render();
  // });

  /* 데이터 양식 
  {
  groupId: 'availableForMeeting',
    title: 'Meeting',
    start: '2023-01-13T11:00:00',
    constraint: 'availableForMeeting', // defined below
    color: '#257e4a',
     end: '2023-01-20',
   display: 'background',
   overlap: false,
  } */
</script>
</head>
<body>

  <div id='calendar'></div>

</body>
</html>
