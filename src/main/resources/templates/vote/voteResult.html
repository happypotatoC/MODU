<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

 <style>
        /* 선택된 항목을 강조하기 위해 스타일 추가 */
        .voteOuterBox {
            display: inline-block;
            border: 2px solid #ccc;
            padding: 10px;
            margin-left:10px;
            width: 280px; /* 외부 박스의 가로 크기를 280px로 지정 */
        }

        .voteInnerBox {
            border: 1px solid #ccc;
            max-height: 200px;
            overflow-y: auto;
            padding: 5px;
            margin: 5px 0;
        }

        .voteItem {
            border: 1px solid #ccc;
            padding: 10px;
            margin: 5px;
            cursor: pointer;
            display: block; /* 위에서 아래로 나열되도록 변경 */
        }

        .voteItem.selected {
            border: 2px solid #435EBE; /* 선택된 항목의 테두리 색상 변경 */
        }

        /* 버튼 스타일 수정 */
        #submitBtn {
            display: block;
            margin: 10px auto;
            padding: 10px 20px;
            font-size: 16px;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #435EBE; /* 푸른색으로 버튼 활성화 상태 설정 */
        }

        /* 비활성화 상태일 때 배경색을 회색으로 설정 */
        #submitBtn:disabled {
            background-color: #888;
        }

        /* 작성자와 날짜, 제목 스타일 추가 */
        .voteHeader {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 10px;
        }

        .voteAuthor {
            font-size: 12px;
        }

        .voteDate {
            font-size: 10px;
        }

        .voteTitle {
            font-size: 14px;
        }

        /* 추가적인 스타일 설정 */
        .voteDeadline {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <h3>투표 항목 선택</h3>
    <hr>


    <!-- 외부 박스 -->
    <div class="voteOuterBox">
        <!-- 작성자와 날짜, 제목을 추가 -->
        <div class="voteHeader" th:if="${voteInfo.brdUniNo != null}">
            <div class="voteAuthor" >[[${voteInfo.particiMembUniNo}]] <h6 class="text-muted mb-0">[[${voteInfo.boardNm}]]</h6></div>
            <div class="voteDate">[[${#dates.format(voteInfo.frDt, 'yyyy-MM-dd')}]]</div>
            <div class="voteTitle">[[${voteInfo.ttl}]]
        </div>
        <div class="voteHeader" th:unless="${voteInfo.brdUniNo != null}">
            <div class="voteAuthor" >[[${voteInfo.particiMembUniNo}]] <h6 class="text-muted mb-0">[[${voteInfo.chatrNm}]]</h6></div>
            <div class="voteDate">[[${#dates.format(voteInfo.frDt, 'yyyy-MM-dd')}]]</div>
            <div class="voteTitle">[[${voteInfo.ttl}]]</div>
        </div>

        <!-- 투표 항목을 선택하는 폼 -->
        <form action id="voteForm1">
            <!-- 내부 박스 -->
            <div class="voteInnerBox" > <!-- 내부 박스로 항목들을 감싸기 -->
                <div class="voteItem" th:each="i:${item}" th:field="*{i.voteDetaNo}" onclick="toggleSelection(this)">
                    [[${i.voteItem}]]
                </div>
                <!-- 마감 날짜 표기 --> 
                <div class="voteDeadline">마감 날짜:[[${#dates.format(voteInfo.toDt,'yyyy-MM-dd')}]]</div>
            </div>

            <!-- 투표 제출 버튼 -->
            <button type="submit" id="submitBtn" disabled>투표 제출하기</button>
        </form>
    </div>
    </div>

    <script>
        // 항목 선택 시 이벤트 처리
        function toggleSelection(item) {
            const selectedItems = document.querySelectorAll('.voteItem.selected');

            if (item.classList.contains('selected')) {
                item.classList.remove('selected');
            } else {
                selectedItems.forEach(selectedItem => selectedItem.classList.remove('selected'));
                item.classList.add('selected');
            }

            // 선택된 항목이 있으면 "투표 제출하기" 버튼 활성화
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = (document.querySelector('.voteItem.selected') === null);
        }

        // 폼 제출 시 처리
        const voteForm1 = document.getElementById('voteForm1');
        voteForm1.addEventListener('submit', function (event) {
            event.preventDefault();
			
            $.ajax('vote')
            // 폼이 제출되면 여기에서 선택된 항목을 서버로 전송하도록 처리할 수 있습니다.
            // 예: AJAX 요청을 통해 선택된 항목을 서버로 전송하고 결과를 받아옴
            const selectedVoteItem = document.querySelector('.voteItem.selected');
            const selectedItem = selectedVoteItem ? selectedVoteItem.innerText : null;

            console.log('선택한 투표 항목:', selectedItem);
        });
    </script>
</body>
</html>